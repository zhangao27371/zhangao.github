<!DOCTYPE html>
<html lang="zh-CN">
<head>
   <meta charset="UTF-8">
   <title>抽奖转盘</title>
   <style>
       body { 
           text-align: center; 
           background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
           min-height: 100vh;
           display: flex;
           flex-direction: column;
           justify-content: center;
           align-items: center;
           font-family: 'Microsoft YaHei', sans-serif;
           padding: 20px;
       }
       
       .box { 
           width: 500px; 
           height: 500px; 
           margin: 10px auto; 
           position: relative; 
           overflow: visible;
           display: flex; 
           justify-content: center; 
           align-items: center; 
       }
       
       /* 外框 */
       .outer-frame {
           position: absolute;
           width: 520px;
           height: 520px;
           border-radius: 50%;
           background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
           box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), inset 0 0 20px rgba(255, 255, 255, 0.3);
           z-index: 0;
       }
       
       /* 内框 */
       .inner-frame {
           position: absolute;
           width: 480px;
           height: 480px;
           border-radius: 50%;
           background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
           box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
           z-index: 1;
       }
       
       .main { 
           width: 460px; 
           height: 460px; 
           box-sizing: border-box; 
           border: 4px solid #fff; 
           border-radius: 50%; 
           overflow: hidden; 
           position: relative; 
           transition: all 5s cubic-bezier(0.25, 0.1, 0.25, 1);
           box-shadow: 0 10px 30px rgba(0,0,0,0.3);
           z-index: 2;
       }
       
       /* 指针容器 */
       .pointer-container {
           position: absolute;
           top: -30px;
           left: 50%;
           transform: translateX(-50%);
           z-index: 10;
       }
       
       /* 指针主体 */
       .pointer {
           width: 0;
           height: 0;
           border-left: 25px solid transparent;
           border-right: 25px solid transparent;
           border-top: 50px solid #ff4444;
           position: relative;
           filter: drop-shadow(0 3px 5px rgba(0,0,0,0.3));
       }
       
       /* 指针高光 */
       .pointer::after {
           content: '';
           position: absolute;
           top: 5px;
           left: 50%;
           transform: translateX(-50%);
           width: 0;
           height: 0;
           border-left: 15px solid transparent;
           border-right: 15px solid transparent;
           border-top: 25px solid rgba(255,255,255,0.3);
       }
       
       /* 猛攻文字样式 */
       .winner { 
           font-size: 36px; 
           color: #ff4444; 
           font-weight: bold;
           margin-top: 30px;
           min-height: 50px;
           text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
           background: rgba(255,255,255,0.1);
           padding: 20px 40px;
           border-radius: 50px;
           display: inline-block;
           border: 2px solid #ff4444;
           animation: pulse 1s infinite;
       }
       
       @keyframes pulse {
           0% { transform: scale(1); }
           50% { transform: scale(1.05); }
           100% { transform: scale(1); }
       }
       
       button {
           background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
           color: white;
           border: none;
           padding: 18px 50px;
           font-size: 20px;
           font-weight: bold;
           border-radius: 50px;
           cursor: pointer;
           transition: all 0.3s;
           box-shadow: 0 8px 20px rgba(255,107,107,0.3);
           margin-top: 30px;
           position: relative;
           overflow: hidden;
       }
       
       button:hover:not(:disabled) {
           transform: translateY(-3px);
           box-shadow: 0 12px 25px rgba(255,107,107,0.4);
       }
       
       button:disabled {
           background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
           cursor: not-allowed;
           transform: none;
       }
       
       button::before {
           content: '';
           position: absolute;
           top: 50%;
           left: 50%;
           width: 0;
           height: 0;
           border-radius: 50%;
           background: rgba(255,255,255,0.3);
           transform: translate(-50%, -50%);
           transition: width 0.6s, height 0.6s;
       }
       
       button:hover:not(:disabled)::before {
           width: 300px;
           height: 300px;
       }
       
       @media (max-width: 600px) {
           .box {
               width: 350px;
               height: 350px;
           }
           
           .outer-frame {
               width: 370px;
               height: 370px;
           }
           
           .inner-frame {
               width: 340px;
               height: 340px;
           }
           
           .main {
               width: 320px;
               height: 320px;
           }
           
           .pointer {
               border-left-width: 20px;
               border-right-width: 20px;
               border-top-width: 40px;
           }
           
           .pointer::after {
               border-left-width: 12px;
               border-right-width: 12px;
               border-top-width: 20px;
           }
           
           button {
               padding: 15px 35px;
               font-size: 18px;
           }
           
           .winner {
               font-size: 28px;
               padding: 15px 30px;
           }
       }
   </style>
</head>
<body>
   <div class="box">
       <!-- 外框 -->
       <div class="outer-frame"></div>
       <!-- 内框 -->
       <div class="inner-frame"></div>
       
       <div class="main" id="wheel" ontransitionend="end()">
           <!-- 转盘内容将通过Canvas动态生成 -->
       </div>
       
       <!-- 简化的指针设计 -->
       <div class="pointer-container">
           <div class="pointer"></div>
       </div>
   </div>
   
   <button onclick="start()" id="startBtn">开始抽奖</button>
   <div class="winner" id="winner"></div>
   
   <script type="text/javascript">
       var rotate = 0;
       var isRunning = false;
       var targetIndex = 0;
       
       // 定义7个奖品，使用更美观的颜色
       var list = [
           { title: '机密航天', color: '#e74c3c' },
           { title: '绝密航天', color: '#3498db' },
           { title: '机密巴克什', color: '#2ecc71' },
           { title: '绝密巴克什', color: '#f39c12' },
           { title: '潮汐监狱', color: '#9b59b6' },
           { title: '机密大坝', color: '#1abc9c' },
           { title: '绝密大坝', color: '#e67e22' }
       ];
       
       var perAngle = 360 / list.length;
       
       // 使用Canvas创建转盘
       function createWheel() {
           const canvas = document.createElement('canvas');
           canvas.width = 460;
           canvas.height = 460;
           const ctx = canvas.getContext('2d');
           
           const centerX = 230;
           const centerY = 230;
           const radius = 220;
           
           // 清空画布
           ctx.clearRect(0, 0, 460, 460);
           
           // 绘制扇形
           for (let i = 0; i < list.length; i++) {
               const startAngle = (i * perAngle - 90) * Math.PI / 180; // 从顶部开始
               const endAngle = ((i + 1) * perAngle - 90) * Math.PI / 180;
               
               // 绘制扇形
               ctx.beginPath();
               ctx.moveTo(centerX, centerY);
               ctx.arc(centerX, centerY, radius, startAngle, endAngle);
               ctx.closePath();
               ctx.fillStyle = list[i].color;
               ctx.fill();
               ctx.strokeStyle = 'white';
               ctx.lineWidth = 3;
               ctx.stroke();
               
               // 绘制文字
               const textAngle = startAngle + (endAngle - startAngle) / 2;
               const textRadius = radius * 0.7;
               const textX = centerX + textRadius * Math.cos(textAngle);
               const textY = centerY + textRadius * Math.sin(textAngle);
               
               ctx.save();
               ctx.translate(textX, textY);
               ctx.rotate(textAngle + Math.PI / 2);
               ctx.fillStyle = 'white';
               ctx.font = 'bold 14px Microsoft YaHei';
               ctx.textAlign = 'center';
               ctx.textBaseline = 'middle';
               ctx.fillText(list[i].title, 0, 0);
               ctx.restore();
           }
           
           // 绘制中心圆
           ctx.beginPath();
           ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);
           ctx.fillStyle = '#fff';
           ctx.fill();
           ctx.strokeStyle = '#ff4444';
           ctx.lineWidth = 3;
           ctx.stroke();
           
           document.getElementById('wheel').appendChild(canvas);
       }
       
       function start() {
           if (isRunning) {
               console.warn('正在转动中...');
               return;
           }
           
           isRunning = true;
           document.getElementById('winner').innerHTML = '';
           document.getElementById('startBtn').disabled = true;
           document.getElementById('startBtn').textContent = '转动中...';
           
           // 随机选择一个奖品
           targetIndex = Math.floor(Math.random() * list.length);
           
           // 精确计算目标角度，确保指针指向格子中心
           // 每个格子的中心角度
           const targetSectorCenter = targetIndex * perAngle + perAngle / 2;
           // 要让这个中心对准指针（顶部），需要旋转的角度
           const rotationNeeded = 90 - targetSectorCenter;
           
           // 增加旋转圈数：最低3圈，最高6圈
           const spins = 3 + Math.floor(Math.random() * 4); // 3-6圈
           rotate = spins * 360 + rotationNeeded;
           
           const wheel = document.getElementById('wheel');
           wheel.style.transform = `rotate(${rotate}deg)`;
           
           console.log('=== 调试信息 ===');
           console.log('旋转圈数:', spins);
           console.log('目标索引:', targetIndex);
           console.log('目标项目:', list[targetIndex].title);
           console.log('目标格子中心角度:', targetSectorCenter);
           console.log('需要旋转角度:', rotationNeeded);
           console.log('总旋转角度:', rotate);
       }
       
       function end() {
           isRunning = false;
           document.getElementById('startBtn').disabled = false;
           document.getElementById('startBtn').textContent = '开始抽奖';
           
           // 只显示"猛攻！"
           document.getElementById('winner').innerHTML = '🔥 猛攻！';
           
           console.log('=== 最终结果 ===');
           console.log('中奖项目:', list[targetIndex].title);
       }
       
       // 页面加载时创建转盘
       window.onload = function() {
           createWheel();
       };
   </script>
</body>
</html>
